# Image-Based Lighting

IBL is a rendering technique that approximates global illumination using environment maps, special textures that store omnidirectional incoming light. Environment maps are typically captured using 360Â° photography, or rendered from 3D scenes. IBL is a very efficient way to add realism to computer games, especially in the PBR pipeline.

## Equirectangular Maps

TODO

## Cube Maps

TODO

## Split Sum Approximation

Introduced by Brian Karis in Epic Games, split sum approximation is an industry-standard method to render image-based specular reflections. It splits the rendering equation into two precomputable parts: a pre-filtered environment map and a 2D lookup table, sometimes called a BRDF integration map or DFG (Distribution, Fresnel, Geometry). This red-green LUT outputs a scale (red channel) and an offset (green channel) for the Fresnel term for different roughness values and viewing angles.

Pre-filtered environment map is generated by convoluting the input cube map using GGX BRDF for different roughness levels. They are stored in the mip chain of the cube map and then sampled in the shader to get a specular reflection for the given material roughness.

In pseudocode:

```
reflection = textureLod(envmap, R, mipLevelForRoughness(roughness)).rgb
brdf = texture(lut, vec2(NE, roughness)).rg
Ls = reflection * (F * brdf.r + brdf.g)
```

Dagon uses Smith DFG which is automatically loaded from `data/__internal/textures/brdf.dds`.

## Usage

TODO
