<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dagon</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #f6f8fa;
      min-height: 100vh;
      display: block;
      overflow-x: hidden;
      background-image: url(images/background.jpg) !important;
      background-position: center center;
      background-size: cover;
      background-repeat: no-repeat;
      background-attachment: fixed;
    }

    .topnav {
      position: sticky;
      top: 0;
      background: white;
      padding: 1rem 0;
      border-bottom: 1px solid #e1e4e8;
      z-index: 1000;
      box-shadow: 0 0 10px rgba(27, 31, 35, 0.1);
    }

    .topnav-container {
      max-width: 980px;
      margin: 0 auto;
      display: flex;
      justify-content: left;
      gap: 2rem;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      font-size: 1rem;
    }

    .topnav a, .dropbtn {
      display: flex;
      align-items: center;
      height: 100%;
      color: #0366d6;
      text-decoration: none;
      vertical-align: middle;
      cursor: pointer;
      white-space: nowrap;
      user-select: none;
      transition: color 0.2s ease;
    }

    .topnav a:hover,
    .topnav a:focus,
    .dropbtn:hover,
    .dropbtn:focus {
      color: #023e8a;
      outline: none;
    }

    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: white;
      min-width: 180px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.1);
      border: 1px solid #e1e4e8;
      border-radius: 4px;
      z-index: 1001;
    }

    .dropdown-content a {
      display: block;
      padding: 0.5rem 1rem;
      color: #24292e;
      white-space: nowrap;
    }

    .dropdown-content a:hover,
    .dropdown-content a:focus {
      background-color: #f6f8fa;
      color: #0366d6;
      outline: none;
    }
    
    .dropdown-content p {
      color: #dddddd;
      padding: 0.5rem 1rem;
      margin: 0;
      cursor: default;
      user-select: none;
      pointer-events: none;
      display: block;
    }

    main {
      flex-grow: 1;
      overflow-y: auto;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
                   Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      line-height: 1.6;
      font-size: 16px;
      color: #24292e;
      max-width: 980px;
      margin: 2rem auto;
      padding: 2rem;
      background: #ffffff;
      border-radius: 6px;
    }

    main h1, main h2, main h3, main h4 {
      margin-top: 1em;
      margin-bottom: 0.75em;
      font-weight: 600;
      line-height: 1.25;
    }
    main h1 { font-size: 2em; border-bottom: 1px solid #e1e4e8; padding-bottom: 0.3em; }
    main h2 { font-size: 1.5em; border-bottom: 1px solid #e1e4e8; padding-bottom: 0.3em; }
    main h3 { font-size: 1.25em; }
    main h4 { font-size: 1.1em; color: #6a737d; }

    main ul, main ol {
      padding-left: 2em;
      margin-top: 0.5em;
      margin-bottom: 0.5em;
    }
    main li {
      margin-bottom: 0.3em;
    }

    main a {
      color: #0366d6;
      text-decoration: none;
    }
    main a:hover {
      text-decoration: underline;
    }

    main blockquote {
      margin: 1em 0;
      padding-left: 1em;
      border-left: 4px solid #dfe2e5;
      color: #6a737d;
    }

    main table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 1em;
    }
    main th, main td {
      border: 1px solid #dfe2e5;
      padding: 0.6em 1em;
    }
    main th {
      background-color: #f6f8fa;
      font-weight: 600;
    }

    main img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 1em auto;
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    main .video-container {
      overflow: hidden;
      position: relative;
      width: 100%;
      max-width: 1024px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    main .video-container::after {
      padding-top: 56.25%;
      display: block;
      content: '';
    }

    main .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/github.min.css">
  <style>
    main code {
      font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;
      background: #f6f8fa;
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-size: 85%;
    }
    main pre code {
      display: block;
      padding: 1em;
      overflow-x: auto;
      background: #f6f8fa !important;
      border: 1px solid #e1e4e8 !important;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <nav class="topnav">
    <div class="topnav-container">
      <a href="?p=overview">Overview</a>
      <a href="?p=features">Features</a>
      <a href="https://github.com/gecko0307/dagon/releases" target="_blank">Download</a>
      <a href="https://gecko0307.github.io/dagon/doc/dagon.html" target="_blank">API Reference</a>
      <div class="dropdown">
        <a href="?p=tutorials" class="dropbtn">Tutorials â–¾</a>
        <div class="dropdown-content">
          <a href="?p=tutorial1">1. Simple Application</a>
          <a href="?p=tutorial2">2. Textures</a>
          <a href="?p=tutorial3">3. Normal Maps</a>
          <a href="?p=tutorial4">4. Light Sources</a>
          <a href="?p=tutorial5">5. Environment Maps</a>
          <a href="?p=tutorial6">6. PBR</a>
          <a href="?p=tutorial7">7. First Person Camera</a>
          <p>8. Procedural Sky</p>
          <a href="?p=tutorial10">9. Post-processing</a>
          <a href="?p=tutorial10">10. Physics</a>
          <a href="?p=tutorial11">11. Exporting Assets from Blender</a>
          <a href="?p=tutorial12">12. Particles</a>
          <a href="?p=tutorial13">13. Custom Shaders</a>
          <a href="?p=tutorial14">14. Input Manager</a>
          <a href="?p=tutorial15">15. Terrain</a>
          <p>16. Decals</p>
          <a href="?p=tutorial17">17. Character Controller</a>
          <a href="?p=tutorial18">18. Nuklear GUI</a>
        </div>
      </div>
    </div>
  </nav>
  <main>
    <div id="markdown-output"></div>
  </main>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/d.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/glsl.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    var pages = {
      "overview": "overview.md",
      "features": "features.md",
      "contributing_guidelines": "guidelines.md",
      "tutorials": "tutorials.md",
      "tutorial1": "tutorials/Tutorial 1. Simple Application.md",
      "tutorial2": "tutorials/Tutorial 2. Textures.md",
      "tutorial3": "tutorials/Tutorial 3. Normal Maps.md",
      "tutorial4": "tutorials/Tutorial 4. Light Sources.md",
      "tutorial5": "tutorials/Tutorial 5. Environment Maps.md",
      "tutorial6": "tutorials/Tutorial 6. PBR.md",
      "tutorial7": "tutorials/Tutorial 7. First Person Camera.md",
      "tutorial8": "tutorials/Tutorial 8. Procedural Sky.md",
      "tutorial9": "tutorials/Tutorial 9. Post-processing.md",
      "tutorial10": "tutorials/Tutorial 10. Physics.md",
      "tutorial11": "tutorials/Tutorial 11. Exporting Assets from Blender.md",
      "tutorial12": "tutorials/Tutorial 12. Particles.md",
      "tutorial13": "tutorials/Tutorial 13. Custom Shaders.md",
      "tutorial14": "tutorials/Tutorial 14. Input Manager.md",
      "tutorial15": "tutorials/Tutorial 15. Terrain.md",
      "tutorial16": "tutorials/Tutorial 16. Decals.md",
      "tutorial17": "tutorials/Tutorial 17. Character Controller.md",
      "tutorial18": "tutorials/Tutorial 18. Nuklear GUI.md"
    };

    function renderContent(section) {
      var url = pages[section];
      fetch(url)
        .then(res => res.text())
        .then(md => {
          document.getElementById("markdown-output").innerHTML = marked.parse(md);
          const firstHeading = md.match(/^#\s+(.*)/m);
          if (firstHeading) {
            document.title = firstHeading[1] + " | Dagon";
          } else {
            document.title = "Dagon";
          }
          
          document.querySelectorAll("pre code").forEach((block) => {
              block.classList.add("language-d");
            });
          
          hljs.highlightAll();
           window.scrollTo({ top: 0, left: 0, behavior: "smooth" });
        })
        .catch(err => {
          document.getElementById("markdown-output").innerHTML = `<p style='color:red;'>Error loading ${url}</p>`;
        });
    }
    
    function loadPage(sectionId) {
        const url = new URL(window.location);
        url.searchParams.set("p", sectionId);
        window.history.pushState({}, "", url);
        renderContent(sectionId);
    }

    window.addEventListener("DOMContentLoaded", () => {
        const params = new URLSearchParams(window.location.search);
        const section = params.get("p");
        console.log(section);
        if (section) renderContent(section);
        else renderContent("overview");
    });
    
    window.addEventListener("popstate", () => {
        const params = new URLSearchParams(window.location.search);
        const section = params.get("p");
        if (section) {
          renderContent(section);
        }
    });

    document.querySelectorAll(".dropdown").forEach(dropdown => {
      const btn = dropdown.querySelector(".dropbtn");
      const menu = dropdown.querySelector(".dropdown-content");

      dropdown.addEventListener("mouseenter", () => {
        menu.style.display = "block";
      });

      dropdown.addEventListener("mouseleave", () => {
        menu.style.display = "none";
      });
      
      btn.addEventListener("click", () => {
          menu.style.display = "none";
      });
      
      menu.querySelectorAll("a").forEach(link => {
        link.addEventListener("click", () => {
          menu.style.display = "none";
        });
      });
    });
  </script>
</body>
</html>
